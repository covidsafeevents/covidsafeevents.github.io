!function(){function e(e,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function n(n,o,t){return o&&e(n.prototype,o),t&&e(n,t),n}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{eNtl:function(e,t,i){"use strict";i.r(t),i.d(t,"BookingPageModule",(function(){return N}));var r,s=i("pMoy"),a=i("UKGz"),c=i("SVse"),l=i("s7LF"),b=i("sZkV"),u=i("iInd"),d=i("mrSG"),h=function e(){o(this,e),this.personFirstName=new l.c("",[l.n.required,l.n.minLength(1)]),this.personLastName=new l.c("",[l.n.required,l.n.minLength(1)]),this.personPhoneNumber=new l.c("",[l.n.required,l.n.minLength(10),l.n.pattern(/^[+)(\d)]+$/)]),this.personEmailAddress=new l.c("",[l.n.required,l.n.minLength(4),l.n.email]),this.isDeclarationChecked=new l.c("",[l.n.requiredTrue])},m=function(){function e(){o(this,e)}return n(e,null,[{key:"createPersonForm",value:function(){return new h}}]),e}(),g=i("t0hA"),f=i("8Y7J"),p=i("h80k"),v=((r=function(){function e(){o(this,e),this.eventName=""}return n(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||r)},r.\u0275cmp=f.Db({type:r,selectors:[["app-covid-declaration"]],inputs:{eventName:"eventName"},decls:31,vars:1,consts:[["text-wrap",""],[2,"padding-left","1em"],["name","call-outline"],["size","10"],["id","check-declaration","aria-label","b","formControlName","isDeclarationChecked"]],template:function(e,n){1&e&&(f.Mb(0,"ion-row"),f.Mb(1,"ion-col"),f.Mb(2,"ion-list"),f.Mb(3,"ion-list-header"),f.nc(4,"Please review the following questions: "),f.Lb(),f.Mb(5,"ion-item",0),f.nc(6," 1. In the last 14 days have you travelled from overseas or a COVID-19 hotspot? "),f.Kb(7,"br"),f.nc(8," \xa0 \xa0 \u5728\u904e\u53bb\u7684 14 \u5929\u4e2d\uff0c\u60a8\u662f\u5f9e\u6d77\u5916, \u9084\u662f\u5f9e COVID-19 \u71b1\u9ede\u56de\u6765? "),f.Lb(),f.Mb(9,"ion-item",0),f.nc(10," 2. Have you been in close contact with a person who is positive for COVID-19? "),f.Kb(11,"br"),f.nc(12," \xa0 \xa0 \u60a8\u662f\u5426\u8207COVID-19\u68c0\u6d4b\u5448\u967d\u6027\u7684\u4eba\u4fdd\u6301\u5bc6\u5207\u806f\u7e6b? "),f.Lb(),f.Mb(13,"ion-item"),f.nc(14," 3. Are you an active COVID-19 case? "),f.Kb(15,"br"),f.nc(16," \xa0 \xa0 \u60a8\u662f\u5426\u60a3\u65b0\u51a0\u75c5\u6bd2COVID-19? "),f.Lb(),f.Mb(17,"ion-item",0),f.nc(18," 4. Are you currently experiencing, or have you recently experienced cough, fever, sore throat, fatigue or shortness of breath? "),f.Kb(19,"br"),f.nc(20," \xa0 \xa0 \u60a8\u76ee\u524d\u6216\u6700\u8fd1\u662f\u5426\u6709\u54b3\u55fd\uff0c\u767c\u71d2\uff0c\u5589\u56a8\u75db\uff0c\u75b2\u52de\u6216\u547c\u5438\u6025\u4fc3? "),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Mb(21,"ion-row"),f.Mb(22,"ion-col"),f.Mb(23,"span",1),f.nc(24),f.Kb(25,"ion-icon",2),f.nc(26,"13 HEALTH). "),f.Lb(),f.Lb(),f.Lb(),f.Mb(27,"ion-row"),f.Mb(28,"ion-col",3),f.Mb(29,"mat-checkbox",4),f.nc(30," By checking this box I declare that I do not have any of these risk factors. "),f.Lb(),f.Lb(),f.Lb()),2&e&&(f.zb(24),f.pc(" If yes to any of the above please do not attend ",n.eventName?n.eventName+" ":""," this week ( "))},directives:[b.u,b.g,b.r,b.s,b.m,b.k,s.a],styles:[""]}),r);function k(e,n){if(1&e&&(f.Mb(0,"div"),f.Mb(1,"ion-button",18),f.Kb(2,"ion-icon",19),f.nc(3," Add Person to Booking "),f.Lb(),f.Mb(4,"button",20),f.Kb(5,"ion-icon",21),f.nc(6," Add Person (enter) "),f.Lb(),f.Lb()),2&e){var o=f.Yb();f.zb(1),f.ec("disabled",o.bookingForm.invalid),f.zb(3),f.ec("disabled",o.bookingForm.invalid)}}function L(e,n){if(1&e){var o=f.Nb();f.Mb(0,"div"),f.Mb(1,"ion-button",22),f.Ub("click",(function(e){f.ic(o);var n=f.Yb(),t=f.hc(8);return n.clickSubmitForm(n.selectedEventUUID,t,e)})),f.nc(2," Register for Sunday service (Chinese hall) "),f.Lb(),f.Lb()}if(2&e){var t=f.Yb();f.zb(1),f.ec("disabled",t.bookingForm.invalid)}}function C(e,n){1&e&&(f.Mb(0,"ion-text",23),f.nc(1," Registrations reached maximum capacity "),f.Lb())}var y,M,w,I=[{path:"",component:(y=function(){function e(n,t,i){o(this,e),this.bookingService=n,this.formBuilder=t,this.toastController=i,this.selectedEventUUID="",this.selectedEventName="",this.bookingChineseUUID="445538f0-e22e-4568-acf8-9bc5bba3ceb6",this.bookingEnglishUUID="81508052-8691-4ff4-a3ef-c36bf7fccc88",this.eventChineseUUID="667c1a54-3c59-4eff-a507-b55a80094249",this.eventEnglishUUID="f883134b-661a-4388-b677-582bc2ea39aa",this.latestPersonsEnglishCap=49,this.latestPersonsChineseCap=49;var r=t.group(m.createPersonForm());this.bookingForm=r}return n(e,[{key:"ngOnInit",value:function(){var e=this;console.log("BookingPage -> ngOnInit");var n=Object(g.b)(this.bookingService.getNumberOfPersonBookingsForEvent());this.latestPersonsCountChinese=n,n.subscribe((function(n){e.chineseCount=n}));var o=Object(g.b)(this.bookingService.getNumberOfPersonBookingsForEvent(this.eventEnglishUUID));this.latestPersonsCountEnglish=o,o.subscribe((function(n){return e.englishCount=n}))}},{key:"clickSubmitForm",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"445538f0-e22e-4568-acf8-9bc5bba3ceb6",o=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.bookingForm,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.bookingService;n===this.bookingEnglishUUID?this.englishCount+=1:this.chineseCount+=1,console.log("BookingPage:: clickSubmitForm() -> form",o,t,i);var s=i.value;""!==s.personFirstName?(o.control.setErrors({invalid:"Saving form..."}),r.addPersonToBookingByUUID(n,s).subscribe((function(n){var o,t,i,r;console.log("BookingPage -> clickSubmitForm -> personBookingResult",n),e.presentToast("Successfully saved booking "+(null===(r=null===(i=null===(t=null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.insert_Person)||void 0===t?void 0:t.returning)||void 0===i?void 0:i[0])||void 0===r?void 0:r.personFirstName)).catch(),e.resetRecreateForm()}),(function(n){e.presentToast("Error saving "+JSON.stringify(n)).catch()}))):this.presentToast("Invalid inputs detected").catch()}},{key:"resetRecreateForm",value:function(){var e=this.formBuilder.group(m.createPersonForm());this.bookingForm=e}},{key:"presentToast",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.toastController;return Object(d.a)(this,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,n.create({message:e,duration:3500,animated:!0,translucent:!0});case 2:return o.abrupt("return",o.sent.present().then((function(){console.log("Toast presented")})));case 3:case"end":return o.stop()}}),o)})))}},{key:"compare",value:function(e,n){return e<n}},{key:"isEnglishCountCappedLocked",get:function(){return this.englishCount>=this.latestPersonsEnglishCap}},{key:"isChineseCountCappedLocked",get:function(){return this.chineseCount>=this.latestPersonsChineseCap}},{key:"isRegistrationAllowedEnglishCountBelowCap",get:function(){return!this.isEnglishCountCappedLocked}},{key:"isRegistrationAllowedChineseCountBelowCap",get:function(){return!this.isChineseCountCappedLocked}}]),e}(),y.\u0275fac=function(e){return new(e||y)(f.Jb(g.a),f.Jb(l.b),f.Jb(b.C))},y.\u0275cmp=f.Db({type:y,selectors:[["app-booking"]],decls:42,vars:6,consts:[[3,"translucent"],["color","cobaltblue"],["slot","start"],[2,"padding-inline-start","0.25em"],[3,"formGroup"],["f","ngForm"],[2,"color","gray"],["col-12","","col-sm-9","","col-md-6","","col-lg-4","","col-xl-3",""],["position","floating"],["formControlName","personFirstName","type","text","placeholder","First name for registration, check in and contact-tracing purposes","required",""],["formControlName","personLastName","type","text","placeholder","Your last name","required",""],["sizeXl","2","sizeLg","2.2","sizeMd","2.5","sizeSm","4","sizeXs","5.6"],["formControlName","personPhoneNumber","type","tel","placeholder","0412345678","size","12","required",""],["formControlName","personEmailAddress","type","text","placeholder","info@example.com","required",""],[3,"eventName"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["maxedChinese",""],["type","button","color","cobaltblue",3,"disabled"],["name","person-add-outline"],["type","button","mat-button","","color","primary","hidden","",3,"disabled"],["name","document-text"],["type","button","color","brightnavyblue",3,"disabled","click"],["color","warning"]],template:function(e,n){if(1&e&&(f.Mb(0,"ion-header",0),f.Mb(1,"ion-toolbar",1),f.Mb(2,"ion-buttons",2),f.Kb(3,"app-home-button"),f.Lb(),f.Mb(4,"ion-title",3),f.nc(5," Booking "),f.Lb(),f.Lb(),f.Lb(),f.Mb(6,"ion-content"),f.Mb(7,"form",4,5),f.Mb(9,"ion-grid"),f.Mb(10,"ion-row",6),f.Mb(11,"ion-col"),f.nc(12," Test"),f.Lb(),f.Lb(),f.Mb(13,"ion-row"),f.Mb(14,"ion-col",7),f.Mb(15,"ion-label",8),f.nc(16," First name "),f.Lb(),f.Kb(17,"ion-input",9),f.Lb(),f.Lb(),f.Mb(18,"ion-row"),f.Mb(19,"ion-col"),f.Mb(20,"ion-label",8),f.nc(21," Last name "),f.Lb(),f.Kb(22,"ion-input",10),f.Lb(),f.Lb(),f.Mb(23,"ion-row"),f.Mb(24,"ion-col",11),f.Mb(25,"ion-label",8),f.nc(26," Phone number "),f.Lb(),f.Kb(27,"ion-input",12),f.Lb(),f.Lb(),f.Mb(28,"ion-row"),f.Mb(29,"ion-col"),f.Mb(30,"ion-label",8),f.nc(31," Email address "),f.Lb(),f.Kb(32,"ion-input",13),f.Lb(),f.Lb(),f.Kb(33,"app-covid-declaration",14),f.Mb(34,"ion-row"),f.Mb(35,"ion-col"),f.lc(36,k,7,2,"div",15),f.Lb(),f.Lb(),f.Mb(37,"ion-row"),f.Mb(38,"ion-col"),f.lc(39,L,3,1,"div",16),f.Lb(),f.Lb(),f.lc(40,C,2,0,"ng-template",null,17,f.mc),f.Lb(),f.Lb(),f.Lb()),2&e){var o=f.hc(41);f.ec("translucent",!0),f.zb(7),f.ec("formGroup",n.bookingForm),f.zb(26),f.ec("eventName",n.selectedEventName),f.zb(3),f.ec("ngIf",n.isRegistrationAllowedEnglishCountBelowCap&&n.isRegistrationAllowedChineseCountBelowCap),f.zb(3),f.ec("ngIf",n.latestPersonsCountEnglish)("ngIfElse",o)}},directives:[b.j,b.x,b.f,p.a,b.w,b.h,l.o,l.k,l.e,b.i,b.u,b.g,b.q,b.l,b.B,l.j,l.d,l.m,v,c.k,b.e,b.k,b.v],styles:[""]}),y)}],E=((w=function e(){o(this,e)}).\u0275mod=f.Hb({type:w}),w.\u0275inj=f.Gb({factory:function(e){return new(e||w)},imports:[[u.i.forChild(I)],u.i]}),w),N=((M=function e(){o(this,e)}).\u0275mod=f.Hb({type:M}),M.\u0275inj=f.Gb({factory:function(e){return new(e||M)},imports:[[c.c,l.f,l.l,b.y,a.a,s.b,E]]}),M)}}])}();