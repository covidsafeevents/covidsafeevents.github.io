!function(){function e(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function r(){var e=l(['\n  mutation CreateEvents(\n    $eventInsertObjects: [Event_insert_input!]! = [\n      {\n        EventSeries: { data: { eventSeriesDetails: "Sunday service (English)", eventSeriesName: "Sunday worship" } }\n        Organiser: { data: { randomUUID: "b669fc76-3130-4c4e-a04e-49e9f067ea9c" } }\n      }\n    ]\n  ) {\n    insert_Event(objects: $eventInsertObjects) {\n      affected_rows\n      returning {\n        eventName\n        eventCapacity\n        eventStartDateTime\n        eventEndDateTime\n        bookingAvailableStartDateTime\n        bookingAvailableEndDateTime\n      }\n    }\n  }\n']);return r=function(){return e},e}function c(){var e=l(["\n  mutation CreateEvent($eventInsertObject: Event_insert_input! = {}) {\n    insert_Event_one(object: $eventInsertObject) {\n      randomUUID\n      bookingAvailableStartDateTime\n      bookingAvailableEndDateTime\n      eventStartDateTime\n      eventEndDateTime\n      eventDateTimeRange\n      bookingAvailabilityDateTimeRange\n      eventName\n      eventTopic\n      eventCategory\n      eventCapacity\n      eventDescription\n      eventMedium\n    }\n  }\n"]);return c=function(){return e},e}function s(){var e=l(['\n  # Get all future events.\n  # Default just in case dumb hasura behaviour doesn\'t return EventRooms but somehow returns Events depending on presence of comparison exp\n  subscription GetAllEvents($eventEndDateTimeGreaterThanEqual: timestamptz = "2020-07-28") {\n    Event(where: { eventEndDateTime: { _gte: $eventEndDateTimeGreaterThanEqual } }, limit: 20) {\n      eventName\n      eventDescription\n      eventStartDateTime\n      eventEndDateTime\n      bookingAvailableStartDateTime\n      bookingAvailableEndDateTime\n      randomUUID\n      updated_at\n      EventRooms {\n        roomName\n        eventRoomUUID\n        eventRoomDetails\n      }\n    }\n  }\n']);return s=function(){return e},e}function l(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{oirr:function(n,a,l){"use strict";l.r(a),l.d(a,"EventsPageModule",(function(){return x}));var v,u=l("UKGz"),m=l("SVse"),b=l("s7LF"),d=l("sZkV"),g=l("iInd"),f=l("LRne"),p=l("lJxs"),h=l("pLZG"),E=l("ZTNX"),D=l("8Y7J"),y=l("lTCR"),T=l.n(y),k=l("IxO4"),O=l("Ok9p"),j=l("nbgS"),I=T.a(s()),S=T.a(c()),_=T.a(r()),w=((v=function(){function e(t){o(this,e),this.apollo=t,console.log("EventService -> constructor ")}return i(e,[{key:"getEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(E.e)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.apollo;return t.subscribe({query:I,fetchPolicy:"cache-first",variables:{eventEndDateTimeGreaterThanEqual:e}})}},{key:"getSeedEventInputObjects",value:function(){var e,n=Object(k.d)(m.o.Sunday,9,0),o=Object(k.d)(m.o.Sunday,10,30),a=Object(k.d)(m.o.Wednesday,0,0),i=Object(k.d)(m.o.Sunday,23,59,59,999),r=Object(k.c)(n,o,a,i);console.log("EventService -> getSeedEventInputObjects -> recurringDates",r);var c=r.map((function(e){var t=e.eventStartEndDateTime,n=t.startDateTime,o=t.endDateTime,a=t.startEndDateTimeRangeTstzRangeText,i=e.bookingStartEndDateTime,r=i.startDateTime,c=i.endDateTime,s=i.startEndDateTimeRangeTstzRangeText;return[C("English hall","English hall for live stream and in-person services",r,c,s,n,o,a,"Sunday service",40,"Description of community event","Church"),C("Chinese hall","Chinese main hall for live stream and in-person services",r,c,s,n,o,a,"\u4e3b\u65e5\u5d07\u62dc",40,"Description of community event","Church")]}));return(e=[]).concat.apply(e,t(c))}},{key:"createEvents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.apollo;return t.mutate({mutation:_,variables:{eventInsertObjects:e}})}},{key:"createEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.apollo,t=new Date,n=new Date(t.getTime()-Object(k.a)(2)),o=new Date(t.getTime()+Object(k.a)(7)),a=new Date(t.getTime()+Object(k.a)(9)),i=new Date(t.getTime()+Object(k.a)(10)),r=(new Date(t.getTime()+Object(k.a)(10)),C("English hall","English hall for live stream and in-person services",n,o,Object(k.b)(n,o),a,i,Object(k.b)(a,i)));return console.log("EventService -> constructor -> eventInsertObject",r),e.mutate({mutation:S,variables:{eventInsertObject:r}})}}]),e}()).\u0275fac=function(e){return new(e||v)(D.Qb(j.b))},v.\u0275prov=D.Fb({token:v,factory:v.\u0275fac,providedIn:"root"}),v);function C(e,t,n,o,a,i,r,c){var s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"Sunday service",l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:40,v=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"Description of community event",u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"Church",m=arguments.length>12&&void 0!==arguments[12]?arguments[12]:"b669fc76-3130-4c4e-a04e-49e9f067ea9c";return{bookingAvailableStartDateTime:n,bookingAvailableEndDateTime:o,bookingAvailabilityDateTimeRange:a,eventStartDateTime:i,eventEndDateTime:r,eventDateTimeRange:c,eventName:s,eventTopic:"Topic",eventMedium:"In-person",eventCategory:u,eventCapacity:l,eventDescription:v,Organiser:{data:{randomUUID:m,organiserDetails:""},on_conflict:{constraint:O.g.Organiser_randomUUID_key,update_columns:[O.h.updated_at]}},EventRooms:{data:[{eventRoomDetails:t,Room:{data:{roomName:e,roomType:"Hall",roomCapacity:49,Venue:{data:{venueName:"Eight Mile Plains Chinese Methodist Church",randomUUID:"9cb826dc-fcf8-406e-8b01-f4eba15dfcc6"},on_conflict:{constraint:O.o.Venue_randomUUID_key,update_columns:[O.p.updated_at]}}},on_conflict:{constraint:O.k.Room_venueID_roomName_key,update_columns:[O.l.updated_at]}}}],on_conflict:{constraint:O.c.EventRoom_eventRoomID_eventID_roomID_venueID_roomName_event_key,update_columns:[O.d.updated_at]}}}}var M,R=l("t0hA"),L=l("h80k"),U=((M=function(){function e(){o(this,e),this.pageTitle=""}return i(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||M)},M.\u0275cmp=D.Db({type:M,selectors:[["app-custom-header"]],inputs:{pageTitle:"pageTitle"},decls:7,vars:1,consts:[["color","cobaltblue"],["slot","start"],["text-left",""]],template:function(e,t){1&e&&(D.Mb(0,"ion-toolbar",0),D.Mb(1,"ion-buttons",1),D.Mb(2,"ion-back-button"),D.nc(3,"Back button"),D.Lb(),D.Kb(4,"app-home-button"),D.Lb(),D.Mb(5,"ion-title",2),D.nc(6),D.Lb(),D.Lb()),2&e&&(D.zb(6),D.oc(t.pageTitle))},directives:[d.x,d.f,d.c,d.d,L.a,d.w],styles:["ion-title[_ngcontent-%COMP%]{-webkit-padding-start:.25em;padding-inline-start:.25em}"]}),M);function A(e,t){if(1&e){var n=D.Nb();D.Mb(0,"ion-item-sliding"),D.Mb(1,"ion-item-options"),D.Mb(2,"ion-item-option",2),D.nc(3,"Check "),D.Lb(),D.Lb(),D.Mb(4,"ion-item",3),D.Ub("click",(function(e){D.ic(n);var o=t.$implicit;return D.Yb().clickEventItem(e,o)})),D.Mb(5,"ion-avatar",4),D.Kb(6,"img",5),D.Lb(),D.Mb(7,"ion-label"),D.Mb(8,"h2"),D.nc(9),D.Lb(),D.Mb(10,"h3"),D.nc(11),D.Lb(),D.Mb(12,"p"),D.nc(13),D.Zb(14,"date"),D.Zb(15,"date"),D.Lb(),D.Lb(),D.Lb(),D.Lb()}if(2&e){var o=t.$implicit;D.zb(9),D.oc(null==o?null:o.eventName),D.zb(2),D.oc(null==o||null==o.EventRooms[0]?null:o.EventRooms[0].roomName),D.zb(2),D.qc(" ",D.bc(14,4,o.eventStartDateTime,"EEEE',' dd MMM HH:mm")," \u2013 ",D.bc(15,7,o.eventEndDateTime,"HH:mm")," ")}}var P,N,z,G=[{path:"",component:(P=function(){function t(e,n,a){o(this,t),this.router=e,this.eventService=n,this.bookingService=a,this.upcomingEvents=Object(f.a)([]),console.log("EventsPage:: constructor")}return i(t,[{key:"ngOnInit",value:function(){console.log("EventsPage:: ngOnInit"),this.upcomingEvents=this.getLatestEvents()}},{key:"getLatestEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eventService;return console.log("EventsPage:: getLatestEvents"),t.getEvents().pipe(Object(p.a)((function(t){e(t.data);var n=t.errors;if(console.log("EventsPage -> eventsResult",t),!((null==n?void 0:n.length)>0))return console.log("%c EventsPage:: subscribeLatestEvents -> events",E.a),t.data.Event})),Object(h.a)((function(e){var t,n,o;return void 0!==e&&void 0!==(null===(t=e[0])||void 0===t?void 0:t.EventRooms)&&void 0!==(null===(o=null===(n=e[0])||void 0===n?void 0:n.EventRooms[0])||void 0===o?void 0:o.roomName)})))}},{key:"clickEventItem",value:function(e,t){arguments.length>2&&void 0!==arguments[2]||this.router,console.log("EventsPage -> eventItemClick -> eventItemClick",e),console.log("EventsPage -> eventItemClick -> event",t.randomUUID)}},{key:"clickTestButton",value:function(e){console.log("EventsPage -> testButton -> event",e),this.seedEvents()}},{key:"seedEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eventService,t=e.getSeedEventInputObjects();console.log("EventsPage -> seedEvents -> getSeedEventInputObjects",t),e.createEvents(t).subscribe((function(e){console.log("EventsPage -> seedEvents -> createdEventsResult",e)}))}}]),t}(),P.\u0275fac=function(e){return new(e||P)(D.Jb(g.g),D.Jb(w),D.Jb(R.a))},P.\u0275cmp=D.Db({type:P,selectors:[["app-events"]],decls:7,vars:3,consts:[["pageTitle","COVIDSafe Events"],[4,"ngFor","ngForOf"],["color","danger"],["button","",3,"click"],["slot","start"],["src","/assets/images/emp-cmca-logo-small-172x172-placeholder.jpg","alt","Placeholder-image-church"]],template:function(e,t){1&e&&(D.Kb(0,"app-custom-header",0),D.Mb(1,"ion-content"),D.Mb(2,"ion-list"),D.Mb(3,"ion-list-header"),D.nc(4,"Upcoming events"),D.Lb(),D.lc(5,A,16,10,"ion-item-sliding",1),D.Zb(6,"async"),D.Lb(),D.Lb()),2&e&&(D.zb(5),D.ec("ngForOf",D.ac(6,1,t.upcomingEvents)))},directives:[U,d.h,d.r,d.s,m.j,d.p,d.o,d.n,d.m,d.b,d.q],pipes:[m.b,m.e],styles:[""]}),P)}],$=((z=function e(){o(this,e)}).\u0275mod=D.Hb({type:z}),z.\u0275inj=D.Gb({factory:function(e){return new(e||z)},imports:[[g.i.forChild(G)],g.i]}),z),x=((N=function e(){o(this,e)}).\u0275mod=D.Hb({type:N}),N.\u0275inj=D.Gb({factory:function(e){return new(e||N)},imports:[[m.c,b.f,d.y,u.a,$]]}),N)}}])}();